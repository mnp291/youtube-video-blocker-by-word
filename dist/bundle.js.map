{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Observer.ts","webpack:///./src/Storage.ts","webpack:///./src/index.ts"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFa;AACb;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,MAAM;AACnF,uCAAuC,cAAc;AACrD,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;;;;;;;;;;;AC9Fa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,2CAA2C;AAClI;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,mFAAmF,2BAA2B;AAC9G;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,gCAAgC;AACvH;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrFa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,qCAAY;AACvC,kBAAkB,mBAAO,CAAC,mCAAW;AACrC;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Observer = void 0;\r\nclass Observer {\r\n    constructor(storage) {\r\n        this.storage = storage;\r\n        this.blockedCards = new Set();\r\n        storage.setCounter(0);\r\n        this.storage.onChange((changes) => {\r\n            if (changes[\"blocker_keyword_list\"]) {\r\n                this.blockCards(document.querySelectorAll('div, span, a'));\r\n            }\r\n        });\r\n    }\r\n    run() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.blockCards(document.querySelectorAll('div, span, a'));\r\n            const obs = new MutationObserver((records) => {\r\n                for (const record of records) {\r\n                    this.blockCards(record.addedNodes);\r\n                }\r\n            });\r\n            obs.observe(document, {\r\n                attributes: true,\r\n                childList: true,\r\n                subtree: true,\r\n            });\r\n        });\r\n    }\r\n    blockCards(elements) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            elements.forEach((element) => __awaiter(this, void 0, void 0, function* () {\r\n                var _a;\r\n                if (element instanceof HTMLElement) {\r\n                    if (!((_a = this.blockedCards) === null || _a === void 0 ? void 0 : _a.has(element))) {\r\n                        const list = yield this.storage.getKeywordList();\r\n                        for (const keyword of list) {\r\n                            if (element.innerText.replace(/\\s+/, \" \").toLowerCase().indexOf(keyword) !== -1) {\r\n                                this.blockCard(element, keyword);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }));\r\n        });\r\n    }\r\n    blockCard(title, keyword) {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.blockedCards.has(title)) {\r\n                return;\r\n            }\r\n            const dis = title.closest('[id=\"dismissable\"], .ytd-section-list-renderer > #contents  [class*=\"item\"] > *');\r\n            const content = dis === null || dis === void 0 ? void 0 : dis.parentElement;\r\n            if (title.closest(\".youtube-blocked-item\") || ((_a = dis === null || dis === void 0 ? void 0 : dis.previousElementSibling) === null || _a === void 0 ? void 0 : _a.classList.contains(\"youtube-blocked-item\"))) {\r\n                return;\r\n            }\r\n            if (!(dis instanceof HTMLElement) || !(content instanceof HTMLElement)) {\r\n                return;\r\n            }\r\n            content.style.position = \"relative\";\r\n            const style = `\n            justify-content: center; \n            align-items: center;\n            text-align: center;\n            display: flex;\n            position: absolute;\n            background-color: gray;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n        `;\r\n            content.innerHTML += `<div class=\"youtube-blocked-item\" style=\"${style}\">\n            <h4 style=\"font-size: 21px; color: white;\">\n                Заблокированно: <b>${keyword}</b>\n            </h4>\n        </div>\n        `;\r\n            this.blockedCards.add(title);\r\n            this.storage.setCounter(document.querySelectorAll(\".youtube-blocked-item\").length);\r\n        });\r\n    }\r\n}\r\nexports.Observer = Observer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Storage = void 0;\r\nclass Storage {\r\n    constructor() {\r\n        var _a;\r\n        this.storage = chrome.storage;\r\n        this.subs = new Set();\r\n        (_a = this.storage) === null || _a === void 0 ? void 0 : _a.onChanged.addListener((e) => {\r\n            this.subsTrigger(e);\r\n        });\r\n    }\r\n    getKeywordList() {\r\n        return new Promise((resolve) => {\r\n            var _a;\r\n            if (!this.storage) {\r\n                resolve([]);\r\n            }\r\n            (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.get(['blocker_keyword_list'], (result) => {\r\n                const list = result.blocker_keyword_list || [];\r\n                resolve(list.map((k) => k.trim()));\r\n            });\r\n        });\r\n    }\r\n    addKeyWord(keyword) {\r\n        return new Promise((resolve) => {\r\n            var _a;\r\n            if (keyword.trim() === \"\") {\r\n                resolve();\r\n                return;\r\n            }\r\n            if (keyword.replace(/\\s+/, \"\").length < 3) {\r\n                resolve();\r\n                return;\r\n            }\r\n            (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.get(['blocker_keyword_list'], (result) => {\r\n                var _a;\r\n                const list = result.blocker_keyword_list || [];\r\n                list.push(keyword.toLowerCase().trim());\r\n                (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.set({ blocker_keyword_list: [...new Set(list)] }, () => {\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    }\r\n    getCounter() {\r\n        return new Promise((resolve) => {\r\n            var _a;\r\n            if (!this.storage) {\r\n                resolve(0);\r\n            }\r\n            (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.get([\"blocker_counter\"], (result) => {\r\n                const counter = parseInt(result.blocker_counter || 0, 10);\r\n                resolve(counter);\r\n            });\r\n        });\r\n    }\r\n    setCounter(counter) {\r\n        return new Promise((resolve) => {\r\n            var _a;\r\n            (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.set({ blocker_counter: counter }, () => {\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n    removeKeyWord(keyword) {\r\n        return new Promise((resolve) => {\r\n            this.getKeywordList().then((list) => {\r\n                var _a;\r\n                const newList = list.filter((k) => k !== keyword.toLowerCase());\r\n                (_a = this.storage) === null || _a === void 0 ? void 0 : _a.local.set({ blocker_keyword_list: newList }, () => {\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    }\r\n    subsTrigger(changes) {\r\n        for (const sub of this.subs) {\r\n            sub(changes);\r\n        }\r\n    }\r\n    onChange(sub) {\r\n        this.subs.add(sub);\r\n    }\r\n}\r\nexports.Storage = Storage;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Observer_1 = require(\"./Observer\");\r\nconst Storage_1 = require(\"./Storage\");\r\nfunction main() {\r\n    const obs = new Observer_1.Observer(new Storage_1.Storage());\r\n    obs.run();\r\n}\r\nmain();\r\n"],"sourceRoot":""}